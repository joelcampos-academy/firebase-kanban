rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      match /departments/{departmentId} {
        allow read, delete: if request.auth != null;

        match /kanban/{taskId} {
          allow read: if request.auth != null;
          allow write, update: if request.auth != null && (request.resource.data.state == 'todo' || request.resource.data.state == 'wip' || request.resource.data.state == 'done')  ;
        }
      }

      allow read, write: if false;
    }
  }
}